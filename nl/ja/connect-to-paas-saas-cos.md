---

copyright:
  years: 2018
lastupdated: "2018-04-24"

---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:codeblock: .codeblock}
{:pre: .pre}
{:screen: .screen}
{:tip: .tip}
{:download: .download}

# 連携: IBM Cloud Direct Link と IBM Cloud オブジェクト・ストレージ

この資料では、IBM Cloud Direct Link を構成して、IBM Cloud オブジェクト・ストレージおよびその他の IBM Cloud サービスにアクセスできるようにする方法について説明します。 実際に IaaS バックボーンの外に出ることなく、IBM Cloud Direct Link が存在するプライベート IBM Cloud IaaS ネットワークから、IBM Cloud PaaS および SaaS 機能をサポートする「パブリック」ネットワークにブリッジングするための方法は複数あります。

現在のポリシーでは、IBM Cloud プライベート・サービス・エンドポイントは、IBM Cloud Direct Link を介してアクセスできません。 この資料で説明している技法では、IBM Cloud によってホストされているシステムを介した間接アクセスを利用します。 プライベート・サービス・エンドポイントは Direct Link によって到達できませんが、お客様のプライベート・サーバーおよびアプライアンスは到達可能にすることができます。

## IBM Cloud オブジェクト・ストレージ (COS) とは

IBM Cloud オブジェクト・ストレージは、非構造化データを保管する Web スケール・プラットフォームです。 複製なしで、信頼性、セキュリティー、可用性、および災害復旧が提供されます。 

IBM Cloud オブジェクト・ストレージで保管された情報は暗号化され、複数の地理的位置に分散されます。 これは、S3 API の実装を介してアクセス可能です。 このサービスは、IBM Cloud オブジェクト・ストレージ・サービスによって提供されている分散ストレージ・テクノロジーを利用します。

IBM COS は、**クロス地域**と**地域**という 2 つの構成で利用可能です。 クロス地域サービスでは、単一地域を使用した場合よりも高い耐久性および可用性が得られますが、待ち時間が若干長くなるという代償を伴います。現在、このサービスは、米国および EU で使用可能です。 地域サービスは、その逆となります。つまり、単一地域内の複数のアベイラビリティー・ゾーンにオブジェクトを分散します。 特定の地域または可用性ゾーンがアクセス不能な場合でも、オブジェクト・ストアは引き続きスムーズに機能します。 適用されていない変更は、アクセス不能なデータ・センターがオンラインに戻ったときに適用されます。

## IBM Cloud Direct Link とは

IBM Cloud Direct Link は、お客様がリモート・ネットワーク環境と IBM Cloud デプロイメントの間のプライベート接続を作成できるようにする製品スイートです。 

## IBM Cloud Direct Link を介したクラウド・オブジェクト・ストレージ (COS) の使用

IBM Cloud Direct Link 接続ソリューション・ファミリーは IaaS オファリングであり、IBM の IaaS サービスへのプライベート WAN 接続を可能にすることを目的としています。 ほとんどの IBM Cloud PaaS および SaaS ソリューションは、IaaS の上に構築されています。 したがって、これらのタイプの接続は、IBM Cloud 内から開始できます。

以下の 3 つの方法は、IBM Cloud Direct Link を使用して IBM Cloud PaaS および SaaS に接続する際に役立ちます。 現在、方式 3 が推奨されるアプローチです。これは、最も徹底的にテストされているためです。

## Direct Link を使用して PaaS および SaaS に接続するための 3 つの方式


### 方式 1: 仮想ルーター・アプライアンス (VRA、Vyatta と呼ばれることもある) を使用して「パブリックへのホップ」を作成する
 
![vyatta-flow.png](images/vyatta-flow.png)



**基本的な前提: ストレージ・エンドポイントに接続するために「パブリック・ホップ」を使用して IBM COS に接続します。**
*この「パブリック・ホップ」は、IBM Cloud IaaS バックボーンの外に出ません。*

* お客様は、IBM COS カスタマー・サポートおよびオンボード・チームの支援を受けてパブリック・エンドポイントを選択し、API キーを受け取ります。
* オンプレミス・ルーターで、お客様は特定のサブネットへの経路を追加することで、IBM Cloud Direct Link を使用した円滑なトラフィックのフローを確保します。
* VRA で、お客様はパブリック・ネットワークをトラバースするため、および IBM COS サービスのパブリック・エンドポイントに到達するための経路を作成します。
* お客様は、VRA ハードウェアの HA ペアをプロビジョンする必要があります (@x)
* 各 VRA メンバーは、パブリック・クラウドの課金および請求処理の料金を相殺するための、1 カ月当たり 20 TB の組み込み帯域幅を受け取ります。
* 前払いの帯域幅を累積するために、ホストされたサーバー全体の帯域幅プールを使用します。


### 方式 2: クラウド・サーバー・パススルー (プライベート間)

![リバース・プロキシー](images/reverse-proxy.png)

**基本的な前提: COS 資格情報を使用して、クラウド・サーバーを信頼します。**

 * お客様は、IBM Cloud で 1 つ以上のサーバー、VSI、またはベアメタルをプロビジョンします。
 * 各サーバーでは、プライベート・インターフェースでのみ接続および要求を listen する、Web ベースまたはスクリプト (Java、Python、PHP など) によるアプリケーションをホストします。
 * サーバー・アプリケーションは、独自の API を使用するか、S3 (の一部) を模倣します。
 * IBM Cloud サーバーのプライベート・インターフェースは、かなり安全です。 VLAN、セキュリティー・グループ、OS ファイアウォール、または VRA を使用して、プライベート・ネットワーク内のアクセスを隔離します。
 * 呼び出し元を検証して API の到達範囲を制限する対策を講じることをお勧めします。
 * お客様のオンプレミス・ネットワーク内のクライアントは、要求のターゲットとしてクラウド・パススルー・サーバーのプライベート IP アドレスを使用します。
 * クライアント・ルーティングおよび DNS の変更が必要です。
 * サーバーでホストされたアプリケーションは、プライベート COS エンドポイントに対して認証済み API 呼び出しを発行して、各要求を処理し、呼び出し元に応答を返します。

### 方式 3: リバース・プロキシー (プライベート間)

現在、この方式が推奨されているアプローチです。

**基本的な前提: COS 資格情報を使用して、オンプレミス・クライアント呼び出し元を信頼します。**

 

 * 方式 2 の改変版として、クラウド・サーバーで Web アプリケーションをホストする代わりに、リバース・プロキシー用に構成された HTTPS サーバー (例えば、NGINX) をホストします。
 * 各サーバーは、自己発行証明書を使用して、HTTPS を listen し、以下で参照される資料に示されているプライベート COS エンドポイントに要求を直接渡します。
 
 ![COS エンドポイント](https://console.bluemix.net/docs/services/cloud-object-storage/basics/endpoints.html)
 
### (COS に固有ではない) クラウドの信頼性およびパフォーマンスを向上させる方法の例については、`serverfault.com` を参照してください。

 * スケーリングおよび回復力を向上させるために、複数のプロキシー・サーバーをデプロイできます。 
 * 基本的なフェイルオーバーおよびロード・バランシング機能には、クライアント・サイドでラウンドロビン DNS を使用します。
 * 保護および中央集中ロギングのために、VRA の背後にプロキシー・サーバーを配置できます。
 
 ## IBM Cloud の機能の管理とプロビジョン 
 
このセクションでは、IBM Cloud Direct Link を使用して接続できる一部の IBM Cloud PaaS および SaaS オファリングの資料へのクイック・リンクを提供します。

## ベアメタル・サーバーのプロビジョン方法

ベアメタルのプロビジョン方法について詳しくは、[この資料](https://console.bluemix.net/docs/bare-metal/about.html#getting-started-with-bare-metal-servers)を参照してください。

## 仮想ルーター・アプライアンス (VRA) のプロビジョン方法

VRA のプロビジョン方法について詳しくは、[この資料](https://console.bluemix.net/docs/infrastructure/virtual-router-appliance/getting-started.html#getting-started)を参照してください。

## IBM Cloud オブジェクト・ストレージ (COS) のプロビジョン方法

 * COS のプロビジョン方法について詳しくは、[この資料](https://console.bluemix.net/catalog/services/cloud-object-storage)を参照してください。
 
 * プライベート・エンドポイント (前述) のいずれかを使用して、バケットまたはプロビジョン済み COS アカウントのオブジェクトとのインターフェースを作成します。
